/**
 * @import {PackageDescriptor} from '../../../../src/types'
 */

/**
 * Folds files ending in `.jorts.js` into a string representation
 *
 * @param {string} filepath
 * @param {PackageDescriptor} packageDescriptor
 * @returns {string}
 */
exports.fold = (filepath, packageDescriptor) => {
  if (!filepath.endsWith('.jorts.js')) {
    throw new Error(`Expected .jorts.js file, got ${filepath}`);
  }
  /** @type {{jorts: (packageDescriptor: PackageDescriptor) => string}} */
  const { jorts } = require(filepath);
  if (typeof jorts !== 'function') {
    throw new Error(`Expected jorts() function, got ${jorts}`);
  }
  return jorts(packageDescriptor);
};

exports.extensions = ['.jorts.js'];
